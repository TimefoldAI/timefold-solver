type: specs.openrewrite.org/v1beta/recipe
name: ai.timefold.solver.migration.ToLatest
displayName: Upgrade to the latest Timefold Solver
description: 'Replace all your calls to deleted/deprecated types and methods of Timefold Solver with their proper alternatives.'
recipeList:
  - ai.timefold.solver.migration.FromOptaPlannerToTimefoldSolver
  - org.openrewrite.properties.ChangePropertyKey:
      oldPropertyKey: timefold.solver.solve-length
      newPropertyKey: timefold.solver.solve.duration
      fileMatcher: '**/application.properties'
  - org.openrewrite.properties.ChangePropertyKey:
      oldPropertyKey: quarkus.timefold.solver.solve-length
      newPropertyKey: quarkus.timefold.solver.solve.duration
      fileMatcher: '**/application.properties'
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.ConstraintFactory from(Class)
      newMethodName: forEach
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.ConstraintFactory fromUnfiltered(Class)
      newMethodName: forEachIncludingUnassigned
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.api.score.stream.ConstraintFactory fromUniquePair(..)
      newMethodName: forEachUniquePair
  - ai.timefold.solver.migration.v8.ScoreManagerMethodsRecipe
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: ai.timefold.solver.core.api.score.ScoreManager
      newFullyQualifiedTypeName: ai.timefold.solver.core.api.solver.SolutionManager
      ignoreDefinition: true
  - ai.timefold.solver.migration.v8.ScoreGettersRecipe
  - ai.timefold.solver.migration.v8.ConstraintRefRecipe
  - ai.timefold.solver.migration.v8.SolverManagerBuilderRecipe
  - ai.timefold.solver.migration.v8.NullableRecipe
  - ai.timefold.solver.migration.v8.SingleConstraintAssertionMethodsRecipe
  - ai.timefold.solver.migration.v8.AsConstraintRecipe
  - ai.timefold.solver.migration.v8.RemoveConstraintPackageRecipe
  - ai.timefold.solver.migration.v8.SolutionManagerRecommendAssignmentRecipe
  - org.openrewrite.java.ChangeMethodName:
      matchOverrides: true
      methodPattern: ai.timefold.solver.core.impl.heuristic.selector.common.decorator.SelectionSorterWeightFactory createSorterWeight(..)
      newMethodName: createSorter
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: ai.timefold.solver.core.impl.heuristic.selector.common.decorator.SelectionSorterWeightFactory
      newFullyQualifiedTypeName: ai.timefold.solver.core.api.domain.common.ComparatorFactory
      ignoreDefinition: true
  - org.openrewrite.java.ChangeAnnotationAttributeName:
      annotationType: ai.timefold.solver.core.api.domain.variable.PlanningVariable
      oldAttributeName: strengthComparatorClass
      newAttributeName: comparatorClass
  - org.openrewrite.java.ChangeAnnotationAttributeName:
      annotationType: ai.timefold.solver.core.api.domain.variable.PlanningVariable
      oldAttributeName: strengthWeightFactoryClass
      newAttributeName: comparatorFactoryClass
  - org.openrewrite.java.ChangeAnnotationAttributeName:
      annotationType: ai.timefold.solver.core.api.domain.entity.PlanningEntity
      oldAttributeName: difficultyComparatorClass
      newAttributeName: comparatorClass
  - org.openrewrite.java.ChangeAnnotationAttributeName:
      annotationType: ai.timefold.solver.core.api.domain.entity.PlanningEntity
      oldAttributeName: difficultyWeightFactoryClass
      newAttributeName: comparatorFactoryClass
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: ai.timefold.solver.core.api.domain.variable.PlanningVariable.NullStrengthComparator
      newFullyQualifiedTypeName: ai.timefold.solver.core.api.domain.variable.PlanningVariable.NullComparator
      ignoreDefinition: true
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: ai.timefold.solver.core.api.domain.variable.PlanningVariable.NullStrengthWeightFactory
      newFullyQualifiedTypeName: ai.timefold.solver.core.api.domain.variable.PlanningVariable.NullComparatorFactory
      ignoreDefinition: true
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: ai.timefold.solver.core.api.domain.entity.PlanningEntity.NullDifficultyComparator
      newFullyQualifiedTypeName: ai.timefold.solver.core.api.domain.entity.PlanningEntity.NullComparator
      ignoreDefinition: true
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: ai.timefold.solver.core.api.domain.entity.PlanningEntity.NullDifficultyWeightFactory
      newFullyQualifiedTypeName: ai.timefold.solver.core.api.domain.entity.PlanningEntity.NullComparatorFactory
      ignoreDefinition: true
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.config.heuristic.selector.move.MoveSelectorConfig getSorterWeightFactoryClass(..)
      newMethodName: getComparatorFactoryClass
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.config.heuristic.selector.move.MoveSelectorConfig setSorterWeightFactoryClass(..)
      newMethodName: setComparatorFactoryClass
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.config.heuristic.selector.move.MoveSelectorConfig withSorterWeightFactoryClass(..)
      newMethodName: withComparatorFactoryClass
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.config.heuristic.selector.entity.EntitySelectorConfig getSorterWeightFactoryClass(..)
      newMethodName: getComparatorFactoryClass
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.config.heuristic.selector.entity.EntitySelectorConfig setSorterWeightFactoryClass(..)
      newMethodName: setComparatorFactoryClass
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.config.heuristic.selector.entity.EntitySelectorConfig withSorterWeightFactoryClass(..)
      newMethodName: withComparatorFactoryClass
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.config.heuristic.selector.value.ValueSelectorConfig getSorterWeightFactoryClass(..)
      newMethodName: getComparatorFactoryClass
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.config.heuristic.selector.value.ValueSelectorConfig setSorterWeightFactoryClass(..)
      newMethodName: setComparatorFactoryClass
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: ai.timefold.solver.core.config.heuristic.selector.value.ValueSelectorConfig withSorterWeightFactoryClass(..)
      newMethodName: withComparatorFactoryClass
  - org.openrewrite.java.ReplaceConstantWithAnotherConstant:
      existingFullyQualifiedConstantName: ai.timefold.solver.core.config.heuristic.selector.entity.EntitySorterManner.DECREASING_DIFFICULTY
      fullyQualifiedConstantName: ai.timefold.solver.core.config.heuristic.selector.entity.EntitySorterManner.DESCENDING
      ignoreDefinition: true
  - org.openrewrite.java.ReplaceConstantWithAnotherConstant:
      existingFullyQualifiedConstantName: ai.timefold.solver.core.config.heuristic.selector.entity.EntitySorterManner.DECREASING_DIFFICULTY_IF_AVAILABLE
      fullyQualifiedConstantName: ai.timefold.solver.core.config.heuristic.selector.entity.EntitySorterManner.DESCENDING_IF_AVAILABLE
      ignoreDefinition: true
  - org.openrewrite.java.ReplaceConstantWithAnotherConstant:
      existingFullyQualifiedConstantName: ai.timefold.solver.core.config.heuristic.selector.value.ValueSorterManner.DECREASING_STRENGTH
      fullyQualifiedConstantName: ai.timefold.solver.core.config.heuristic.selector.value.ValueSorterManner.DESCENDING
      ignoreDefinition: true
  - org.openrewrite.java.ReplaceConstantWithAnotherConstant:
      existingFullyQualifiedConstantName: ai.timefold.solver.core.config.heuristic.selector.value.ValueSorterManner.DECREASING_STRENGTH_IF_AVAILABLE
      fullyQualifiedConstantName: ai.timefold.solver.core.config.heuristic.selector.value.ValueSorterManner.DESCENDING_IF_AVAILABLE
      ignoreDefinition: true
  - org.openrewrite.java.ReplaceConstantWithAnotherConstant:
      existingFullyQualifiedConstantName: ai.timefold.solver.core.config.heuristic.selector.value.ValueSorterManner.INCREASING_STRENGTH
      fullyQualifiedConstantName: ai.timefold.solver.core.config.heuristic.selector.value.ValueSorterManner.ASCENDING
      ignoreDefinition: true
  - org.openrewrite.java.ReplaceConstantWithAnotherConstant:
      existingFullyQualifiedConstantName: ai.timefold.solver.core.config.heuristic.selector.value.ValueSorterManner.INCREASING_STRENGTH_IF_AVAILABLE
      fullyQualifiedConstantName: ai.timefold.solver.core.config.heuristic.selector.value.ValueSorterManner.ASCENDING_IF_AVAILABLE
      ignoreDefinition: true
  - org.openrewrite.java.RemoveUnusedImports
  - ai.timefold.solver.migration.ChangeVersion
